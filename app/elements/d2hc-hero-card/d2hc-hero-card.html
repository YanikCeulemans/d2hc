<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../d2hc-hero-ability/d2hc-hero-ability.html">

<polymer-element name="d2hc-hero-card" attributes="herodata">
  <template>
    <link rel="stylesheet" href="d2hc-hero-card.css">
    <div id="wrapper" layout vertical center>
        <div class="name-container" self-stretch layout horizontal justified>
            <h2 class="hero-name" flex self-end>{{herodata.name}}</h2>
            <img id="prime" src="{{getPrimePath(herodata.prime)}}" alt="Strength hero" width="31" height="33">
        </div>
        <img src="{{herodata.portrait}}" alt="Hero image" id="portrait" width="268" height="262">
        <div layout horizontal justified self-stretch class="hero-abilities-wrapper">
            <span id="ability-space-reserve"></span>
            <template repeat="{{ability in herodata.abilities}}">
                <d2hc-hero-ability src="{{ability.img}}" alt="img alt">
                    <div tip>
                        <h2>{{ability.name}}</h2>
                        <p>{{ability.description}}</p>
                    </div>
                </d2hc-hero-ability>
            </template>
        </div>
    </div>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        created: function(){
            this.herodata = {};
        },
        ready: function() {
            var images = this.$.wrapper.querySelectorAll('img'), i = 0, 
                len = images.length;
            for (; i < len; i++){
                var currImg = images[i];
                currImg.setAttribute('unresolved', '');
                currImg.onload = function(){
                    this.setAttribute('resolved', '');
                    this.removeAttribute('unresolved');
                }
            }
        },
        setData: function(data){
            this.herodata = data;
            console.log(this.herodata);
        },
        getPrimePath: function(type){
            if (type){
                return '/images/hero-type-' + type + '.png';
            }
            return '';
        }
      });

    })();
  </script>
</polymer-element>
